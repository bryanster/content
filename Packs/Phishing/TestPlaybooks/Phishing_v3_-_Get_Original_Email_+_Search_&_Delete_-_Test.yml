description: test test
fromversion: 6.2.0
id: Phishing v3 - Get Original Email + Search & Delete - Test
inputs: []
name: Phishing v3 - Get Original Email + Search & Delete - Test
outputs: []
starttaskid: '0'
tasks:
  '0':
    id: '0'
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - '1'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: ''
      id: 5b6dfaac-84cd-4edb-8b6c-651195f88cb8
      iscommand: false
      name: ''
      version: -1
    taskid: 5b6dfaac-84cd-4edb-8b6c-651195f88cb8
    timertriggers: []
    type: start
    view: "{\n  \"position\": {\n    \"x\": 450,\n    \"y\": -90\n  }\n}"
  '1':
    id: '1'
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - '20'
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      all:
        simple: true
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      id: 551653e4-a502-421f-8201-f4578a987126
      iscommand: false
      name: Delete Context
      scriptName: DeleteContext
      type: regular
      version: -1
    taskid: 551653e4-a502-421f-8201-f4578a987126
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 450,\n    \"y\": 45\n  }\n}"
  '10':
    id: '10'
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - '8'
    note: false
    quietmode: 0
    scriptarguments:
      id:
        complex:
          root: FoundID
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: Searches Demisto incidents
      id: 5d4c6e63-45fc-49c1-8ede-3250db6ee19a
      iscommand: false
      name: Get final incident fields
      scriptName: SearchIncidentsV2
      type: regular
      version: -1
    taskid: 5d4c6e63-45fc-49c1-8ede-3250db6ee19a
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": -100,\n    \"y\": 1790\n  }\n}"
  '12':
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: HTML
                root: Email
          operator: containsGeneral
          right:
            value:
              simple: http://157.230.37.22/banks/Scotia/
      label: true
    id: '12'
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - '13'
      true:
      - '14'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      id: 5ae8c6a7-724e-4784-853f-f57f7a92559a
      iscommand: false
      name: Does the retrieved email contain the correct HTML?
      type: condition
      version: -1
    taskid: 5ae8c6a7-724e-4784-853f-f57f7a92559a
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 750,\n    \"y\": 2120\n  }\n}"
  '13':
    id: '13'
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      message:
        simple: Something with the HTML of the retrieved email is wrong. Most likely,
          the original email was not retrieved.
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: Prints an error entry with a given message
      id: a4f238f0-88a4-4c90-8e59-af9d55b5a460
      iscommand: false
      name: Error about mismatch in the email HTML
      scriptName: PrintErrorEntry
      type: regular
      version: -1
    taskid: a4f238f0-88a4-4c90-8e59-af9d55b5a460
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 750,\n    \"y\": 2330\n  }\n}"
  '14':
    id: '14'
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: ''
      id: ccb0ff8b-edb8-4f79-87b5-1eef64a83233
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: ccb0ff8b-edb8-4f79-87b5-1eef64a83233
    timertriggers: []
    type: title
    view: "{\n  \"position\": {\n    \"x\": 460,\n    \"y\": 2930\n  }\n}"
  '15':
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: emailsubject
                root: foundIncidents.CustomFields
          operator: isEqualString
          right:
            value:
              simple: Suspicious activity in your bank account [ACTION REQUIRED]
      label: true
    id: '15'
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - '19'
      true:
      - '14'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      id: c9f6edee-984f-425e-8547-bb6bc1d2d77f
      iscommand: false
      name: Was the subject of the original email set?
      type: condition
      version: -1
    taskid: c9f6edee-984f-425e-8547-bb6bc1d2d77f
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": -100,\n    \"y\": 2130\n  }\n}"
  '16':
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: emailfrom
                root: foundIncidents.CustomFields
          operator: isNotEqualString
          right:
            iscontext: true
            value:
              complex:
                accessor: reporteremailaddress
                root: foundIncidents.CustomFields
      - - left:
            iscontext: true
            value:
              complex:
                accessor: reporteremailaddress
                root: foundIncidents.CustomFields
          operator: isNotEmpty
      label: true
    id: '16'
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - '28'
      true:
      - '14'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      id: b76ef571-e1dc-4a92-85d5-d0c655d82021
      iscommand: false
      name: Is the reporter address different than the phishing sender?
      type: condition
      version: -1
    taskid: b76ef571-e1dc-4a92-85d5-d0c655d82021
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": -580,\n    \"y\": 2130\n  }\n}"
  '17':
    id: '17'
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - '25'
      - '39'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: ''
      id: 05950b06-0ff0-4d36-8910-5d463b7f8651
      iscommand: false
      name: Additional Flow Checks
      type: title
      version: -1
    taskid: 05950b06-0ff0-4d36-8910-5d463b7f8651
    timertriggers: []
    type: title
    view: "{\n  \"position\": {\n    \"x\": 2760,\n    \"y\": 1780\n  }\n}"
  '19':
    id: '19'
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      message:
        simple: The subject of the retrieved email was not set in the Process Email
          - Generic playbook, or the original email was not retrieved at all.
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: Prints an error entry with a given message
      id: d8621326-3263-47b4-82e9-c87de781ad07
      iscommand: false
      name: Error - subject is not the subject of the retrieved email
      scriptName: PrintErrorEntry
      type: regular
      version: -1
    taskid: d8621326-3263-47b4-82e9-c87de781ad07
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": -100,\n    \"y\": 2330\n  }\n}"
  '20':
    id: '20'
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - '21'
    note: false
    quietmode: 0
    scriptarguments:
      body:
        simple: 'We''ve detected suspicious activity in your bank account on 05/12/2021.Please
          take a moment to review your recent activity and report anything suspicious
          immediately.Make sure to login and follow the instructions on our official
          website: www.scotiabank.com<https://eur01.safelinks.protection.outlook.com/?url=http%3A%2F%2F157.230.37.22%2Fbanks%2FScotia%2F&data=04%7C01%7Csr-test01%40demistodev.onmicrosoft.com%7Ca068915160cb49db31d508d9b9a33929%7Cebac1a1681bf449b8d435732c3c1d999%7C1%7C0%7C637744932980194392%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&sdata=I7reVHNGh7ifFcOWXFdfQWFXmwK3MVxFLEgiMPiG7Jo%3D&reserved=0>.Should
          you have any questions, please contact us at SUPPORT@SCOTlABANK.COMScotiabank'
      htmlBody:
        simple: "<div style=\"font-family: Calibri, Arial, Helvetica, sans-serif;font-size:\
          \ 12pt;color: rgb(0, 0, 0);\"><span style=\"font-size: 12pt;background-color:\
          \ rgb(255, 255, 255);\">We&#39;ve detected suspicious\_activity in your\
          \ bank\_account on 05/12/2021.</span> <div style=\"font-size: 12pt;background-color:\
          \ rgb(255, 255, 255);\">Please take a moment to review your recent activity\
          \ and report anything suspicious immediately.</div><div style=\"font-size:\
          \ 12pt;background-color: rgb(255, 255, 255);\">Make sure to login and follow\_\
          the\_instructions on our official website:<span>\_</span><a href=\"https://eur01.safelinks.protection.outlook.com/?url=http%3A%2F%2F157.230.37.22%2Fbanks%2FScotia%2F&amp;data=04%7C01%7Csr-test01%40demistodev.onmicrosoft.com%7Ca068915160cb49db31d508d9b9a33929%7Cebac1a1681bf449b8d435732c3c1d999%7C1%7C0%7C637744932980194392%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000&amp;sdata=I7reVHNGh7ifFcOWXFdfQWFXmwK3MVxFLEgiMPiG7Jo%3D&amp;reserved=0\"\
          \ target=\"_blank\" style=\"\" rel=\"nofollow noopener\">www.scotiabank.com</a>.</div><div\
          \ style=\"font-size: 12pt;background-color: rgb(255, 255, 255);\"><br></div><div\
          \ style=\"font-size: 12pt;background-color: rgb(255, 255, 255);\">Should\
          \ you have any questions, please contact us at SUPPORT@SCOTlABANK.COM</div><span\
          \ style=\"font-size: 12pt;background-color: rgb(255, 255, 255);\"><span\
          \ style=\"\">Scotiabank</span></span><br></div>"
      subject:
        simple: Suspicious activity in your bank account [ACTION REQUIRED]
      to:
        simple: sr-test01@demistodev.onmicrosoft.com
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: Sends an email using EWS.
      id: 601b7c9b-3fcf-4255-8016-7ea04080788d
      iscommand: true
      name: Send email from attacker to victim
      script: '|||send-mail'
      type: regular
      version: -1
    taskid: 601b7c9b-3fcf-4255-8016-7ea04080788d
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 450,\n    \"y\": 200\n  }\n}"
  '21':
    id: '21'
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - '22'
    note: false
    quietmode: 0
    scriptarguments:
      seconds:
        simple: '120'
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: Sleep for X seconds
      id: 4aabdbd4-9579-4d2f-865c-48396a4cd2d4
      iscommand: false
      name: Wait for email to arrive and be forwarded by rule to Testbox
      scriptName: Sleep
      type: regular
      version: -1
    taskid: 4aabdbd4-9579-4d2f-865c-48396a4cd2d4
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 450,\n    \"y\": 365\n  }\n}"
  '22':
    id: '22'
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - '23'
    note: false
    quietmode: 0
    scriptarguments:
      name:
        simple: 'FW: Suspicious activity in your bank account [ACTION REQUIRED]'
      status:
        simple: Pending
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: 'Searches Demisto incidents.


        This automation runs using the default Limited User role, unless you explicitly
        change the permissions.

        For more information, see the section about permissions here:

        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations'
      id: c17bd9a8-4c8b-4106-8fb8-c9c6cc12e72e
      iscommand: false
      name: Find the new incident
      scriptName: SearchIncidentsV2
      type: regular
      version: -1
    taskid: c17bd9a8-4c8b-4106-8fb8-c9c6cc12e72e
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 450,\n    \"y\": 530\n  }\n}"
  '23':
    id: '23'
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - '4'
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      key:
        simple: FoundID
      value:
        complex:
          accessor: id
          root: foundIncidents
          transformers:
          - args:
              descending:
                value:
                  simple: 'true'
            operator: sort
          - args:
              index:
                value:
                  simple: '0'
            operator: atIndex
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: Set a value in context under the key you entered.
      id: 7ff35099-6b5d-4ed6-89c1-5e3e50b95c4f
      iscommand: false
      name: Save found incident ID
      scriptName: Set
      type: regular
      version: -1
    taskid: 7ff35099-6b5d-4ed6-89c1-5e3e50b95c4f
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 450,\n    \"y\": 690\n  }\n}"
  '24':
    id: '24'
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - '10'
    note: false
    quietmode: 0
    scriptarguments:
      all:
        simple: false
      key:
        simple: foundIncidents
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: 'Delete field from context.


        This automation runs using the default Limited User role, unless you explicitly
        change the permissions.

        For more information, see the section about permissions here:

        https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.10/Cortex-XSOAR-Administrator-Guide/Automations'
      id: 96379a52-cc12-4452-8867-4e44fc0a9878
      iscommand: false
      name: Clear found incident
      scriptName: DeleteContext
      type: regular
      version: -1
    taskid: 96379a52-cc12-4452-8867-4e44fc0a9878
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": -100,\n    \"y\": 1590\n  }\n}"
  '25':
    id: '25'
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - '40'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: ''
      id: 15d8b3b8-d253-4b58-8d39-05cb2633f221
      iscommand: false
      name: Check Search & Delete
      type: title
      version: -1
    taskid: 15d8b3b8-d253-4b58-8d39-05cb2633f221
    timertriggers: []
    type: title
    view: "{\n  \"position\": {\n    \"x\": 3030,\n    \"y\": 1920\n  }\n}"
  '28':
    id: '28'
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      message:
        simple: Either the Reporter Email Address is empty (problem with the mapper),
          or the Email From doesn't equal the Reporter Email Address (problem with
          Process Email - Generic subplaybook). In case of the latter, need to see
          if the original email was retrieved and parsed correctly using ParseEmailFiles.
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: Prints an error entry with a given message
      id: f24718c3-3f69-4bb3-8628-a5838fd8a9cf
      iscommand: false
      name: Error - email from is same as reporter, or reporter is empty
      scriptName: PrintErrorEntry
      type: regular
      version: -1
    taskid: f24718c3-3f69-4bb3-8628-a5838fd8a9cf
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": -580,\n    \"y\": 2320\n  }\n}"
  '29':
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: severity
                root: foundIncidents
          operator: isEqualString
          right:
            value:
              simple: '3'
      label: true
    id: '29'
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - '30'
      true:
      - '14'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      id: e89e3133-cbb0-42c7-806c-e2371ea7afd0
      iscommand: false
      name: Is the severity of the incident high?
      type: condition
      version: -1
    taskid: e89e3133-cbb0-42c7-806c-e2371ea7afd0
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": -1120,\n    \"y\": 2120\n  }\n}"
  '30':
    id: '30'
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    scriptarguments:
      message:
        simple: 'The incident severity should be high, but it isn''t. This could indicate
          one of the following problems:

          1. The threat intelligence integration used reached its quota.

          2. The threat intelligence integration used no longer detects the malicious
          URL as malicious.

          3. The way we calculate severity for incidents has changed.'
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: Prints an error entry with a given message
      id: cc09666a-6569-4b17-80c7-99f806e9697c
      iscommand: false
      name: Error - final severity not calculated correctly
      scriptName: PrintErrorEntry
      type: regular
      version: -1
    taskid: cc09666a-6569-4b17-80c7-99f806e9697c
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": -1120,\n    \"y\": 2320\n  }\n}"
  '31':
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: URL.Data
          operator: containsGeneral
          right:
            value:
              simple: http://157.230.37.22/banks/Scotia/
      - - left:
            iscontext: true
            value:
              simple: Domain.Name
          operator: containsGeneral
          right:
            value:
              simple: www.scotiabank.com
      label: true
    id: '31'
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - '33'
      true:
      - '14'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      id: 05253ef9-b221-4c92-8475-236d2e716702
      iscommand: false
      name: Were the URL & domain extracted successfully?
      type: condition
      version: -1
    taskid: 05253ef9-b221-4c92-8475-236d2e716702
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 1220,\n    \"y\": 2120\n  }\n}"
  '32':
    id: '32'
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - '9'
    note: false
    quietmode: 0
    scriptarguments:
      get_key:
        simple: URL
      incident_id:
        complex:
          root: FoundID
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: Gets a value from the specified incident's context.
      id: f10d0f63-49f9-42dd-848b-b670de3b0e0d
      iscommand: false
      name: Get the URL context
      scriptName: GetByIncidentId
      type: regular
      version: -1
    taskid: f10d0f63-49f9-42dd-848b-b670de3b0e0d
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 1230,\n    \"y\": 1780\n  }\n}"
  '33':
    id: '33'
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - '14'
    note: false
    quietmode: 0
    scriptarguments:
      message:
        simple: The URL or the domain were not extracted properly. The legitimate
          URL and the malicious URL should have been extracted using incident auto-extract
          settings or field extraction rules (in XSOAR 6.1+). If auto-extract is OK,
          it could be an issue with the threat intelligence integration.
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: Prints an error entry with a given message
      id: 5755c8a0-4fbd-4191-884f-0b0859685a49
      iscommand: false
      name: The URL or domain were not extracted
      scriptName: PrintErrorEntry
      type: regular
      version: -1
    taskid: 5755c8a0-4fbd-4191-884f-0b0859685a49
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 1220,\n    \"y\": 2340\n  }\n}"
  '34':
    id: '34'
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - '9'
    note: false
    quietmode: 0
    scriptarguments:
      get_key:
        simple: File
      incident_id:
        complex:
          root: FoundID
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: Gets a value from the specified incident's context.
      id: 521817a0-8599-4b50-8cf2-47e32748539b
      iscommand: false
      name: Get the File context
      scriptName: GetByIncidentId
      type: regular
      version: -1
    taskid: 521817a0-8599-4b50-8cf2-47e32748539b
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 1680,\n    \"y\": 1780\n  }\n}"
  '35':
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                filters:
                - - ignorecase: true
                    left:
                      iscontext: true
                      value:
                        simple: File.Extension
                    operator: isEqualString
                    right:
                      value:
                        simple: eml
                - - left:
                      iscontext: true
                      value:
                        simple: File.Name
                    operator: isEqualString
                    right:
                      value:
                        simple: Suspicious activity in your bank account [ACTION REQUIRED].eml
                root: File
          operator: isNotEmpty
      label: true
    id: '35'
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - '36'
      true:
      - '14'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      id: e7902c34-c49b-4403-815b-3185770d968d
      iscommand: false
      name: Was the original email retrieved as an EML file?
      type: condition
      version: -1
    taskid: e7902c34-c49b-4403-815b-3185770d968d
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 1680,\n    \"y\": 2120\n  }\n}"
  '36':
    id: '36'
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - '14'
    note: false
    quietmode: 0
    scriptarguments:
      message:
        simple: 'The original email was not retrieved at all, or was not retrieved
          as an EML file which is what is expected to happen.

          Possible reasons:

          - Something in the Process Email - Generic v2 or Get Original Email - Generic
          v2 playbooks changed.

          - Something in the EWS365 integration changed and the retrieved file is
          no longer retrieved as a file.

          - The email was deleted from the mailbox where it was received (probably
          sr-test01) by someone or something else.'
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: Prints an error entry with a given message
      id: e08691f7-965b-4e9d-8993-a693fc813b07
      iscommand: false
      name: Email not retrieved as EML
      scriptName: PrintErrorEntry
      type: regular
      version: -1
    taskid: e08691f7-965b-4e9d-8993-a693fc813b07
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 1680,\n    \"y\": 2340\n  }\n}"
  '37':
    id: '37'
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - '42'
    note: false
    quietmode: 0
    scriptarguments:
      complete_task:
        simple: 'true'
      incident_id:
        complex:
          root: FoundID
      interval_between_tries:
        simple: '15'
      max_timeout:
        simple: '700'
      task_name:
        simple: Manually search & delete emails
      task_states:
        simple: Waiting
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: Wait and complete tasks by given status. Used for test playbooks.
      id: 7d4ed8a1-8551-4d55-8447-63f9a608dc65
      iscommand: false
      name: Wait and manually remediate
      scriptName: WaitAndCompleteTask
      type: regular
      version: -1
    taskid: 7d4ed8a1-8551-4d55-8447-63f9a608dc65
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 450,\n    \"y\": 1030\n  }\n}"
  '38':
    id: '38'
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - '24'
      - '7'
      - '32'
      - '34'
      - '17'
      - '41'
    note: false
    quietmode: 0
    scriptarguments:
      complete_task:
        simple: 'false'
      incident_id:
        complex:
          root: FoundID
      interval_between_tries:
        simple: '10'
      max_timeout:
        simple: '2500'
      task_name:
        simple: Close investigation
      task_states:
        simple: Completed
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: Wait and complete tasks by given status. Used for test playbooks.
      id: 18b04ccd-6b1a-4001-8c95-17912760a292
      iscommand: false
      name: Wait for incident to close
      scriptName: WaitAndCompleteTask
      type: regular
      version: -1
    taskid: 18b04ccd-6b1a-4001-8c95-17912760a292
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 450,\n    \"y\": 1350\n  }\n}"
  '39':
    id: '39'
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - '14'
    note: false
    quietmode: 0
    reputationcalc: 1
    scriptarguments:
      complete_task:
        simple: 'false'
      incident_id:
        complex:
          root: FoundID
      interval_between_tries:
        simple: '10'
      max_timeout:
        simple: '1000'
      task_name:
        simple: Get URL screenshot
      task_states:
        simple: Completed
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: Wait and complete tasks by given status. Used for test playbooks.
      id: 33ee15c2-2683-4cbc-84c8-cccde008f40d
      iscommand: false
      name: Check that URL screenshot was taken
      scriptName: WaitAndCompleteTask
      type: regular
      version: -1
    taskid: 33ee15c2-2683-4cbc-84c8-cccde008f40d
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 2520,\n    \"y\": 1940\n  }\n}"
  '4':
    id: '4'
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - '37'
    note: false
    quietmode: 2
    reputationcalc: 1
    scriptarguments:
      id:
        complex:
          root: FoundID
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.investigate
      id: 6219c046-3f65-4cd9-8a1e-c6c6c592751d
      iscommand: true
      name: Investigate the incident
      script: Builtin|||investigate
      type: regular
      version: -1
    taskid: 6219c046-3f65-4cd9-8a1e-c6c6c592751d
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 450,\n    \"y\": 850\n  }\n}"
  '40':
    id: '40'
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - '14'
    note: false
    quietmode: 0
    scriptarguments:
      complete_task:
        simple: 'false'
      incident_id:
        complex:
          root: FoundID
      interval_between_tries:
        simple: '10'
      max_timeout:
        simple: '1000'
      task_name:
        simple: Search action - Soft delete.
      task_states:
        simple: Completed
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: Wait and complete tasks by given status. Used for test playbooks.
      id: 7e3bd83b-e9e0-4aa9-8f1d-93a85049d85d
      iscommand: false
      name: Check that soft delete was performed
      scriptName: WaitAndCompleteTask
      type: regular
      version: -1
    taskid: 7e3bd83b-e9e0-4aa9-8f1d-93a85049d85d
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 3030,\n    \"y\": 2050\n  }\n}"
  '41':
    id: '41'
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - '9'
    note: false
    quietmode: 0
    scriptarguments:
      get_key:
        simple: Domain
      incident_id:
        complex:
          root: FoundID
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: Gets a value from the specified incident's context.
      id: ea4712aa-4ba9-4cf0-82e3-05d22850fd65
      iscommand: false
      name: Get the Domain context
      scriptName: GetByIncidentId
      type: regular
      version: -1
    taskid: ea4712aa-4ba9-4cf0-82e3-05d22850fd65
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 2090,\n    \"y\": 1780\n  }\n}"
  '42':
    continueonerrortype: ''
    id: '42'
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - '38'
    note: false
    quietmode: 0
    scriptarguments:
      complete_task:
        simple: 'true'
      incident_id:
        complex:
          root: FoundID
      interval_between_tries:
        simple: '15'
      max_timeout:
        simple: '700'
      task_name:
        simple: Which indicators would you like to block?
      task_states:
        simple: Waiting
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: Wait and complete tasks by given status. Used for test playbooks.
      id: 2c7ee888-9db0-4346-8e14-89b6ebe0a05b
      iscommand: false
      name: Wait and manually remediate - Block indicators task
      scriptName: WaitAndCompleteTask
      type: regular
      version: -1
    taskid: 2c7ee888-9db0-4346-8e14-89b6ebe0a05b
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 450,\n    \"y\": 1190\n  }\n}"
  '7':
    id: '7'
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - '9'
    note: false
    quietmode: 0
    scriptarguments:
      get_key:
        simple: Email
      incident_id:
        complex:
          root: FoundID
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: Gets a value from the specified incident's context.
      id: e9610f0b-1554-43e2-8eb5-2ab6608a02ab
      iscommand: false
      name: Get the final Email context
      scriptName: GetByIncidentId
      type: regular
      version: -1
    taskid: e9610f0b-1554-43e2-8eb5-2ab6608a02ab
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 750,\n    \"y\": 1780\n  }\n}"
  '8':
    id: '8'
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - '15'
      - '16'
      - '29'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: ''
      id: 711c28eb-f235-4de8-8647-31c8dc7e5c80
      iscommand: false
      name: Incident Field Checks
      type: title
      version: -1
    taskid: 711c28eb-f235-4de8-8647-31c8dc7e5c80
    timertriggers: []
    type: title
    view: "{\n  \"position\": {\n    \"x\": -100,\n    \"y\": 1970\n  }\n}"
  '9':
    id: '9'
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - '12'
      - '31'
      - '35'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: ''
      id: 84f92104-506c-4488-8956-16a346ac9793
      iscommand: false
      name: Context Checks
      type: title
      version: -1
    taskid: 84f92104-506c-4488-8956-16a346ac9793
    timertriggers: []
    type: title
    view: "{\n  \"position\": {\n    \"x\": 1000,\n    \"y\": 1960\n  }\n}"
tests:
- No tests (auto formatted)
version: -1
view: "{\n  \"linkLabelsPosition\": {\n    \"16_14_Yes\": 0.12,\n    \"31_33_#default#\"\
  : 0.59\n  },\n  \"paper\": {\n    \"dimensions\": {\n      \"height\": 3085,\n \
  \     \"width\": 4530,\n      \"x\": -1120,\n      \"y\": -90\n    }\n  }\n}"
