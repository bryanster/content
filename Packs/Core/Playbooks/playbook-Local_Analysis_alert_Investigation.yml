id: Local Analysis alert Investigation
version: -1
name: Local Analysis alert Investigation
description: |-
  When an unknown executable, DLL, or macro attempts to run on a Windows or Mac endpoint, the Cortex XDR agent uses local analysis to determine if it is likely to be malware. Local analysis uses a static set of pattern-matching rules that inspect multiple file features and attributes, and a statistical model that was developed with machine learning on WildFire threat intelligence.

  **Investigative Actions:**

  Investigate the executed process image and verify if it is malicious using:

  * XDR trusted signers
  * VT trusted signers
  * VT detection rate
  * NSRL DB

  **Response Actions**

  The playbook's first response action is a containment plan that is based on the initial data provided within the alert. In that phase, the playbook will execute:

  * Auto block indicators
  * Auto file quarantine
  * Manual endpoint isolation

  When the playbook executes, it checks for additional activity using the Endpoint Investigation Plan playbook, and another phase, which includes containment and eradication, is executed.

  This phase will execute the following containment actions:

  * Manual block indicators
  * Manual file quarantine
  * Auto endpoint isolation

  And the following eradication actions:

  * Manual process termination
  * Manual file deletion
  * Manual reset of the userâ€™s password

  External resources:

  [Malware Protection Flow](https://docs-cortex.paloaltonetworks.com/r/Cortex-XSIAM/Cortex-XSIAM-Administrator-Guide/File-Analysis-and-Protection-Flow).
starttaskid: '0'
tasks:
  '0':
    id: '0'
    taskid: ac738cbe-735a-4d36-89a0-9b2c5035d105
    type: start
    task:
      id: ac738cbe-735a-4d36-89a0-9b2c5035d105
      version: -1
      name: ''
      iscommand: false
      brand: ''
      description: ''
    nexttasks:
      '#none#':
      - '3'
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 430,
          "y": -1800
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "2":
    id: "2"
    taskid: a65df4c3-9864-491e-80ea-0c3f897eb195
    type: condition
    task:
      id: a65df4c3-9864-491e-80ea-0c3f897eb195
      version: -1
      name: Verdict by FileVerdict AND Prevalence
      description: Checks the verdict returned by the 'Enrichment for Verdict' playbook.
      type: condition
      iscommand: false
      brand: ''
    nexttasks:
      '#default#':
      - '33'
      True Positive:
      - "81"
    separatecontext: false
    conditions:
    - label: True Positive
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: FileVerdict
            iscontext: true
          right:
            value:
              simple: Suspicious
          ignorecase: true
      - - operator: isEqualString
          left:
            value:
              complex:
                root: Core.AnalyticsPrevalence.Hash
                accessor: value
            iscontext: true
          right:
            value:
              simple: "false"
          ignorecase: true
    view: |-
      {
        "position": {
          "x": 430,
          "y": -1000
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  '3':
    id: '3'
    taskid: 7b678a2e-b641-4ae1-8b07-2642ab57819e
    type: title
    task:
      id: 7b678a2e-b641-4ae1-8b07-2642ab57819e
      version: -1
      name: Analysis
      type: title
      iscommand: false
      brand: ''
      description: ''
    nexttasks:
      '#none#':
      - '61'
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 430,
          "y": -1660
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  '6':
    id: '6'
    taskid: 13bca2ec-8023-4b10-8638-57eccb281205
    type: condition
    task:
      id: 13bca2ec-8023-4b10-8638-57eccb281205
      version: -1
      name: 'Was the action prevented? '
      description: Checks if the file execution was prevented.
      type: condition
      iscommand: false
      brand: ''
    nexttasks:
      '#default#':
      - '57'
      Blocked:
      - '35'
    separatecontext: false
    conditions:
    - label: Blocked
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: alert
                accessor: action
            iscontext: true
          right:
            value:
              simple: BLOCKED
          ignorecase: true
    view: |-
      {
        "position": {
          "x": 900,
          "y": -310
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  '14':
    id: '14'
    taskid: 10526d59-d046-4f71-84c1-db47ea1a2cde
    type: condition
    task:
      id: 10526d59-d046-4f71-84c1-db47ea1a2cde
      version: -1
      name: Check WF alert verdict
      description: Checks the WildFire verdict.
      type: condition
      iscommand: false
      brand: ''
    nexttasks:
      '#default#':
      - "39"
      Benign:
      - "85"
      Greyware:
      - "86"
    separatecontext: false
    conditions:
    - label: Benign
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: WildFire.Verdicts
                accessor: Verdict
            iscontext: true
          right:
            value:
              simple: "0"
    - label: Greyware
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: WildFire.Verdicts.Verdict
            iscontext: true
          right:
            value:
              simple: "2"
      - - operator: isEqualString
          left:
            value:
              simple: inputs.GraywareAsMalware
            iscontext: true
          right:
            value:
              simple: "False"
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 900,
          "y": 825
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "33":
    id: "33"
    taskid: 8562e98f-b613-43f9-8f18-1217c5ad9a92
    type: title
    task:
      id: 8562e98f-b613-43f9-8f18-1217c5ad9a92
      version: -1
      name: Handle FP
      type: title
      iscommand: false
      brand: ''
      description: ''
    nexttasks:
      '#none#':
      - "75"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 430,
          "y": 1640
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  '34':
    id: '34'
    taskid: 2df0fb69-bd40-4e5e-8870-3ee4e45ab299
    type: condition
    task:
      id: 2df0fb69-bd40-4e5e-8870-3ee4e45ab299
      version: -1
      name: Manual review - was it your security vendor?
      description: |+
        Was it your security vendor?
        Script from your IT?

        ....

      type: condition
      iscommand: false
      brand: ''
    nexttasks:
      No:
      - '39'
      "Yes":
      - "67"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 430,
          "y": 2075
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  '35':
    id: '35'
    taskid: 8389b41e-5503-4171-8d82-6e3419fcb702
    type: title
    task:
      id: 8389b41e-5503-4171-8d82-6e3419fcb702
      version: -1
      name: WildFire Verdict
      type: title
      iscommand: false
      brand: ''
      description: ''
    nexttasks:
      '#none#':
      - '14'
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 900,
          "y": 690
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  '39':
    id: '39'
    taskid: 32d9a55d-2ba3-47f3-8fe6-c36a66fb0d4e
    type: title
    task:
      id: 32d9a55d-2ba3-47f3-8fe6-c36a66fb0d4e
      version: -1
      name: Investigate
      type: title
      iscommand: false
      brand: ''
      description: ''
    nexttasks:
      '#none#':
      - '63'
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 900,
          "y": 2250
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  '41':
    id: '41'
    taskid: 23366267-1d6e-4775-84b3-ae63febde1ee
    type: title
    task:
      id: 23366267-1d6e-4775-84b3-ae63febde1ee
      version: -1
      name: Remediation
      type: title
      iscommand: false
      brand: ''
      description: ''
    nexttasks:
      '#none#':
      - '64'
      - '65'
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 900,
          "y": 2800
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  '44':
    id: '44'
    taskid: c4572436-ec12-49fd-894b-b345d7894a44
    type: condition
    task:
      id: c4572436-ec12-49fd-894b-b345d7894a44
      version: -1
      name: Found relevant information?
      description: Checks if other alerts were found on the endpoint.
      type: condition
      iscommand: false
      brand: ''
    nexttasks:
      '#default#':
      - "47"
      yes:
      - '41'
      - "76"
    separatecontext: false
    conditions:
    - label: yes
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: FoundIncidents
            iscontext: true
          right:
            value: {}
    view: |-
      {
        "position": {
          "x": 900,
          "y": 2560
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  '45':
    id: '45'
    taskid: 27efa602-3fe1-404b-86e4-98a8055fd207
    type: regular
    task:
      id: 27efa602-3fe1-404b-86e4-98a8055fd207
      version: -1
      name: Close alert
      description: commands.local.cmd.close.inv
      script: Builtin|||closeInvestigation
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - '51'
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 900,
          "y": 3980
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  '46':
    id: '46'
    taskid: 893e14f7-cbe1-47f2-86f2-9b6bed0b72d3
    type: condition
    task:
      id: 893e14f7-cbe1-47f2-86f2-9b6bed0b72d3
      version: -1
      name: Restore affected endpoint?
      description: Whether to execute the Recovery Plan playbook.
      type: condition
      iscommand: false
      brand: ''
    nexttasks:
      '#default#':
      - '47'
      yes:
      - '66'
    separatecontext: false
    conditions:
    - label: yes
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: inputs.AutoRecovery
            iscontext: true
          right:
            value:
              simple: 'True'
          ignorecase: true
    view: |-
      {
        "position": {
          "x": 900,
          "y": 3300
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  '47':
    id: '47'
    taskid: 69ce3c87-29bf-4aef-84f1-91ee25986459
    type: condition
    task:
      id: 69ce3c87-29bf-4aef-84f1-91ee25986459
      version: -1
      name: Close alert automatically?
      description: Whether to close the alert automatically.
      type: condition
      iscommand: false
      brand: ''
    nexttasks:
      '#default#':
      - "51"
      - "48"
      yes:
      - '45'
    separatecontext: false
    conditions:
    - label: yes
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: inputs.AutoCloseAlert
            iscontext: true
          right:
            value:
              simple: 'True'
          ignorecase: true
    view: |-
      {
        "position": {
          "x": 900,
          "y": 3640
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  '48':
    id: '48'
    taskid: 2c5820a1-08cd-4d7f-8ef9-672778d28448
    type: regular
    task:
      id: 2c5820a1-08cd-4d7f-8ef9-672778d28448
      version: -1
      name: Continue with the incident investigation
      description: Continue manually with the alert investigation.
      type: regular
      iscommand: false
      brand: ''
    nexttasks:
      '#none#':
      - '45'
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1270,
          "y": 3810
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  '50':
    id: '50'
    taskid: 53a29f66-4d86-430d-85d6-a1906c35da77
    type: title
    task:
      id: 53a29f66-4d86-430d-85d6-a1906c35da77
      version: -1
      name: Recovery
      type: title
      iscommand: false
      brand: ''
      description: ''
    nexttasks:
      '#none#':
      - '46'
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 900,
          "y": 3125
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  '51':
    id: '51'
    taskid: b530df4e-4acf-4d79-8395-5b0e469704b6
    type: title
    task:
      id: b530df4e-4acf-4d79-8395-5b0e469704b6
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ''
      description: ''
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 40,
          "y": 4150
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  '54':
    id: '54'
    taskid: 6aea084a-ae6b-4638-8239-7d008724cb83
    type: title
    task:
      id: 6aea084a-ae6b-4638-8239-7d008724cb83
      version: -1
      name: Pre-Investigation Containment
      type: title
      iscommand: false
      brand: ''
      description: ''
    nexttasks:
      '#none#':
      - '58'
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1410,
          "y": 180
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  '55':
    id: '55'
    taskid: 82453e9b-41b5-487f-8b69-4f7cc96b12f7
    type: condition
    task:
      id: 82453e9b-41b5-487f-8b69-4f7cc96b12f7
      version: -1
      name: Check hash execution timestamp
      description: Checks for the hash execution timestamp.
      type: condition
      iscommand: false
      brand: ''
    nexttasks:
      '#default#':
      - '35'
      24H:
      - '54'
    separatecontext: false
    conditions:
    - label: 24H
      condition:
      - - operator: greaterThanOrEqual
          left:
            value:
              complex:
                root: alert
                accessor: autime
            iscontext: true
          right:
            value:
              complex:
                root: LastDayTimeNowUnix
            iscontext: true
    view: |-
      {
        "position": {
          "x": 1410,
          "y": 20
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  '57':
    id: '57'
    taskid: 0d876040-7dba-4146-818c-a3e7b3f310c9
    type: regular
    task:
      id: 0d876040-7dba-4146-818c-a3e7b3f310c9
      version: -1
      name: Get time for the last day
      description: |
        Retrieves the current date and time.
      scriptName: GetTime
      type: regular
      iscommand: false
      brand: ''
    nexttasks:
      '#none#':
      - '55'
    scriptarguments:
      contextKey:
        simple: LastDay
      daysAgo:
        simple: '1'
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1410,
          "y": -140
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  '58':
    id: '58'
    taskid: d39b984c-d62c-4527-8360-d812576dd9e9
    type: condition
    task:
      id: d39b984c-d62c-4527-8360-d812576dd9e9
      version: -1
      name: Is auto-containment set to true?
      description: Checks the AutoContainment input.
      type: condition
      iscommand: false
      brand: ''
    nexttasks:
      '#default#':
      - '35'
      yes:
      - '62'
    separatecontext: false
    conditions:
    - label: yes
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: inputs.AutoContainment
                transformers:
                - operator: toLowerCase
            iscontext: true
          right:
            value:
              simple: 'true'
    view: |-
      {
        "position": {
          "x": 1410,
          "y": 320
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  '59':
    id: '59'
    taskid: 003ef4a5-7a94-4e4d-85f7-774ea1bf5865
    type: regular
    task:
      id: 003ef4a5-7a94-4e4d-85f7-774ea1bf5865
      version: -1
      name: Retrieve the suspected file
      description: Retrieves files from selected endpoints. You can retrieve up to 20 files, from no more than 10 endpoints. At least one endpoint ID and one file path are necessary in order to run the command. After running this command, you can use the core-action-status-get command with returned action_id, to check the action status.
      script: '|||core-retrieve-files'
      type: regular
      iscommand: true
      brand: ''
    nexttasks:
      '#none#':
      - '60'
    scriptarguments:
      endpoint_ids:
        complex:
          root: inputs.AgentID
      windows_file_paths:
        complex:
          root: inputs.Path
      timeout_in_seconds:
        simple: "300"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 1590
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  '60':
    id: '60'
    taskid: 423bf925-1698-49ea-8666-9be084cc0650
    type: regular
    task:
      id: 423bf925-1698-49ea-8666-9be084cc0650
      version: -1
      name: Get retrieved file
      description: View the file retrieved by the core-retrieve-files command according to the action ID. Before running this command, you can use the core-action-status-get command to check if this action completed successfully.
      script: '|||core-retrieve-file-details'
      type: regular
      iscommand: true
      brand: ''
    nexttasks:
      '#none#':
      - '68'
    scriptarguments:
      action_id:
        complex:
          root: Core.RetrievedFiles
          accessor: action_id
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 1750
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "61":
    id: "61"
    taskid: 4272a42c-4f7a-4b1f-8513-4a888453d287
    type: playbook
    task:
      id: 4272a42c-4f7a-4b1f-8513-4a888453d287
      version: -1
      name: Enrichment for Verdict
      playbookName: Enrichment for Verdict
      type: playbook
      iscommand: false
      brand: ''
      description: 'This playbook checks prior alert closing reasons and performs enrichment and prevalence checks on different IOC types. It then returns the information needed to establish the alert''s verdict.'
    nexttasks:
      '#none#':
      - "79"
    scriptarguments:
      CloseReason:
        simple: Resolved - False Positive,Resolved - Duplicate Incident,Resolved - Known Issue
      Domain:
        complex:
          root: alert
          accessor: domainname
      FileSHA256:
        complex:
          root: inputs.SHA256
      IP:
        complex:
          root: alert
          accessor: hostip
      URL:
        complex:
          root: alert
          accessor: url
      User:
        complex:
          root: alert
          accessor: username
      query:
        complex:
          root: inputs.Query
      threshold:
        simple: "5"
    separatecontext: true
    continueonerrortype: ""
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 430,
          "y": -1520
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "62":
    id: "62"
    taskid: fe446d1f-57e5-4fbf-84ff-9ccdf4cff7f8
    type: playbook
    task:
      id: fe446d1f-57e5-4fbf-84ff-9ccdf4cff7f8
      version: -1
      name: Containment Plan
      description: "This playbook handles all the containment actions available with Cortex XSIAM, including:  \n* Isolate endpoint\n* Disable account\n* Quarantine file\n* Block indicators\n* Clear user session (currently, the playbook supports only Okta)\n\nNote: The playbook inputs enable manipulating the execution flow; read the input descriptions for details."
      playbookName: Containment Plan
      type: playbook
      iscommand: false
      brand: ''
    nexttasks:
      '#none#':
      - '35'
    scriptarguments:
      AutoContainment:
        complex:
          root: inputs.AutoContainment
          transformers:
          - operator: SetIfEmpty
            args:
              applyIfEmpty: {}
              defaultValue:
                value:
                  simple: 'true'
      BlockIndicators:
        simple: 'True'
      ClearUserSessions:
        simple: 'False'
      EndpointID:
        complex:
          root: inputs.AgentID
      FileContainment:
        simple: 'True'
      FileHash:
        complex:
          root: inputs.SHA256
      FilePath:
        complex:
          root: inputs.Path
      FileRemediation:
        complex:
          root: inputs.FileRemediation
      HostContainment:
        simple: 'True'
      IAMUserDomain:
        simple: ''
      UserContainment:
        simple: "True"
      UserVerification:
        simple: "False"
      Username:
        complex:
          root: alert
          accessor: username
          transformers:
          - operator: uniq
    separatecontext: false
    loop:
      iscommand: false
      exitCondition: ''
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 1410,
          "y": 510
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "63":
    id: "63"
    taskid: ec4bed80-4e42-480c-811f-176e51c67624
    type: playbook
    task:
      id: ec4bed80-4e42-480c-811f-176e51c67624
      version: -1
      name: Endpoint Investigation Plan
      description: "This playbook handles all the endpoint investigation actions available with Cortex XSIAM, including the following tasks:\n* Pre-defined MITRE tactics\n* Host fields (Host ID)\n* Attacker fields (Attacker IP, External host)\n* MITRE techniques\n* File hash (currently, the playbook supports only SHA256)  \n\nNote: The playbook inputs enable manipulating the execution flow; read the input descriptions for details."
      playbookName: Endpoint Investigation Plan
      type: playbook
      iscommand: false
      brand: ''
    nexttasks:
      '#none#':
      - '44'
    scriptarguments:
      HuntCnCTechniques:
        simple: 'True'
      HuntCollectionTechniques:
        simple: 'True'
      HuntDefenseEvasionTechniques:
        simple: 'True'
      HuntDiscoveryTechniques:
        simple: 'True'
      HuntExecutionTechniques:
        simple: 'True'
      HuntImpactTechniques:
        simple: 'True'
      HuntInitialAccessTechniques:
        simple: 'True'
      HuntLateralMovementTechniques:
        simple: 'True'
      HuntPersistenceTechniques:
        simple: 'True'
      HuntPrivilegeEscalationTechniques:
        simple: 'True'
      HuntReconnaissanceTechniques:
        simple: 'True'
      agentID:
        complex:
          root: inputs.AgentID
      timeRange:
        simple: 2 hours ago
    separatecontext: false
    loop:
      iscommand: false
      exitCondition: ''
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 900,
          "y": 2390
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "64":
    id: "64"
    taskid: 3ac3998f-0c05-4b67-8a85-a982a9e17158
    type: playbook
    task:
      id: 3ac3998f-0c05-4b67-8a85-a982a9e17158
      version: -1
      name: Containment Plan
      description: "This playbook handles all the containment actions available with Cortex XSIAM, including:  \n* Isolate endpoint\n* Disable account\n* Quarantine file\n* Block indicators\n* Clear user session (currently, the playbook supports only Okta)\n\nNote: The playbook inputs enable manipulating the execution flow; read the input descriptions for details."
      playbookName: Containment Plan
      type: playbook
      iscommand: false
      brand: ''
    nexttasks:
      '#none#':
      - '50'
    scriptarguments:
      AutoContainment:
        complex:
          root: inputs.AutoContainment
          transformers:
          - operator: SetIfEmpty
            args:
              applyIfEmpty: {}
              defaultValue:
                value:
                  simple: 'false'
      BlockIndicators:
        simple: 'True'
      ClearUserSessions:
        simple: 'True'
      EndpointID:
        complex:
          root: inputs.AgentID
      FileContainment:
        simple: 'True'
      FileHash:
        complex:
          root: alert
          transformers:
          - operator: If-Then-Else
            args:
              condition:
                value:
                  simple: lhs!=rhs
              conditionB: {}
              conditionInBetween: {}
              else:
                value:
                  simple: foundIncidents.CustomFields.initiatorsha256
                iscontext: true
              equals: {}
              lhs:
                value:
                  simple: alert.filesha256
                iscontext: true
              lhsB: {}
              options: {}
              optionsB: {}
              rhs: {}
              rhsB: {}
              then:
                value:
                  simple: foundIncidents.CustomFields.filesha256
                iscontext: true
          - operator: uniq
      FilePath:
        complex:
          root: alert
          transformers:
          - operator: If-Then-Else
            args:
              condition:
                value:
                  simple: lhs!=rhs
              conditionB: {}
              conditionInBetween: {}
              else:
                value:
                  simple: foundIncidents.CustomFields.initiatorpath
                iscontext: true
              equals: {}
              lhs:
                value:
                  simple: alert.filesha256
                iscontext: true
              lhsB: {}
              options: {}
              optionsB: {}
              rhs: {}
              rhsB: {}
              then:
                value:
                  simple: foundIncidents.CustomFields.filepath
                iscontext: true
          - operator: uniq
      FileRemediation:
        complex:
          root: inputs.FileRemediation
      HostContainment:
        simple: "True"
      UserContainment:
        simple: "True"
      UserVerification:
        simple: "False"
      Username:
        complex:
          root: foundIncidents.CustomFields
          accessor: username
    separatecontext: false
    loop:
      iscommand: false
      exitCondition: ''
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 1300,
          "y": 2940
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "65":
    id: "65"
    taskid: bf1ad403-5c0b-4033-82d3-0f786989e686
    type: playbook
    task:
      id: bf1ad403-5c0b-4033-82d3-0f786989e686
      version: -1
      name: Eradication Plan
      description: "This playbook handles all the eradication actions available with Cortex XSIAM, including the following tasks:\n* Reset user password\n* Delete file\n* Kill process (currently, the playbook supports terminating a process by name)  \n\nNote: The playbook inputs enable manipulating the execution flow; read the input descriptions for details."
      playbookName: Eradication Plan
      type: playbook
      iscommand: false
      brand: ''
    nexttasks:
      '#none#':
      - '50'
    scriptarguments:
      AutoEradicate:
        complex:
          root: inputs.AutoEradication
      EndpointID:
        complex:
          root: inputs.AgentID
      FilePath:
        complex:
          root: alert
          transformers:
          - operator: If-Then-Else
            args:
              condition:
                value:
                  simple: lhs!=rhs
              conditionB: {}
              conditionInBetween: {}
              else:
                value:
                  simple: foundIncidents.CustomFields.initiatorpath
                iscontext: true
              equals: {}
              lhs:
                value:
                  simple: alert.filesha256
                iscontext: true
              lhsB: {}
              options: {}
              optionsB: {}
              rhs: {}
              rhsB: {}
              then:
                value:
                  simple: foundIncidents.CustomFields.filepath
                iscontext: true
      FileRemediation:
        complex:
          root: inputs.FileRemediation
      Username:
        complex:
          root: foundIncidents.CustomFields
          accessor: username
    separatecontext: false
    loop:
      iscommand: false
      exitCondition: ''
      wait: 1
      max: 0
    view: |-
      {
        "position": {
          "x": 900,
          "y": 2960
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "66":
    id: "66"
    taskid: a397193c-0582-4cc0-822f-1734252bdbbd
    type: playbook
    task:
      id: a397193c-0582-4cc0-822f-1734252bdbbd
      version: -1
      name: Recovery Plan
      description: |-
        This playbook handles all the recovery actions available with Cortex XSIAM, including the following tasks:
        * Unisolate endpoint
        * Restore quarantined file

        Note: The playbook inputs enable manipulating the execution flow; read the input descriptions for details.
      playbookName: Recovery Plan
      type: playbook
      iscommand: false
      brand: ''
    nexttasks:
      '#none#':
      - '47'
    scriptarguments:
      FileHash:
        complex:
          root: inputs.SHA256
      endpointID:
        complex:
          root: inputs.AgentID
      releaseFile:
        simple: 'False'
      unIsolateEndpoint:
        simple: 'False'
    separatecontext: false
    loop:
      iscommand: false
      exitCondition: ''
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 1370,
          "y": 3470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "67":
    id: "67"
    taskid: 28f0986d-5f8f-491c-89eb-752219ab6e22
    type: playbook
    task:
      id: 28f0986d-5f8f-491c-89eb-752219ab6e22
      version: -1
      name: Handle False Positive Alerts
      playbookName: Handle False Positive Alerts
      type: playbook
      iscommand: false
      brand: ''
      description: |
        This playbook handles false positive alerts.
        It creates an alert exclusion or alert exception, or adds a file to an allow list based on the alert fields and playbook inputs.
    nexttasks:
      '#none#':
      - '51'
    scriptarguments:
      FileSHA256:
        complex:
          root: inputs.SHA256
      ShouldCloseAutomatically:
        complex:
          root: inputs.AutoCloseAlert
      ShouldHandleFPautomatically:
        complex:
          root: inputs.ShouldManualReviewFP
      alertName:
        complex:
          root: alert
          accessor: name
      sourceIP:
        complex:
          root: alert
          accessor: hostip
      username:
        complex:
          root: alert
          accessor: username
    separatecontext: true
    loop:
      iscommand: false
      exitCondition: ''
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 40,
          "y": 2390
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  '68':
    id: '68'
    taskid: 39aa6951-f29c-4abc-81b6-0791b82fccff
    type: regular
    task:
      id: 39aa6951-f29c-4abc-81b6-0791b82fccff
      version: -1
      name: |
        Extract retrieved file
      description: Unzip a file using fileName or entryID to specify a file. Unzipped files are loaded to the War Room and names are put in the context.
      scriptName: UnzipFile
      type: regular
      iscommand: false
      brand: ''
    nexttasks:
      '#none#':
      - '69'
    scriptarguments:
      lastZipFileInWarroom:
        simple: yes
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 1910
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  '69':
    id: '69'
    taskid: 2c517593-1e5b-4fa6-81ab-990ead58cacd
    type: playbook
    task:
      id: 2c517593-1e5b-4fa6-81ab-990ead58cacd
      version: -1
      name: Wildfire Detonate and Analyze File
      description: |
        This playbook uploads, detonates, and analyzes files for the Wildfire sandbox.
      playbookName: Wildfire Detonate and Analyze File
      type: playbook
      iscommand: false
      brand: ''
    nexttasks:
      '#none#':
      - "39"
    scriptarguments:
      File:
        complex:
          root: File
          filters:
          - - operator: isNotEqualString
              left:
                value:
                  simple: File.Name
                iscontext: true
              right:
                value:
                  simple: manifest.json
              ignorecase: true
          - - operator: in
              left:
                value:
                  simple: File.Name
                iscontext: true
              right:
                value:
                  simple: ExtractedFiles
                iscontext: true
    separatecontext: true
    loop:
      iscommand: false
      scriptArguments:
        File:
          complex:
            root: File
            filters:
            - - operator: isNotEqualString
                left:
                  value:
                    simple: File.Name
                  iscontext: true
                right:
                  value:
                    simple: manifest.json
                ignorecase: true
            - - operator: in
                left:
                  value:
                    simple: File.Name
                  iscontext: true
                right:
                  value:
                    simple: ExtractedFiles
                  iscontext: true
      exitCondition: ''
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 2070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  '70':
    id: '70'
    taskid: 7b5bf611-e2ab-49f5-86f2-8fae9a319ca1
    type: condition
    task:
      id: 7b5bf611-e2ab-49f5-86f2-8fae9a319ca1
      version: -1
      name: Check WildFire alert verdict
      description: Checks the WildFire verdict received.
      type: condition
      iscommand: false
      brand: ''
    nexttasks:
      '#default#':
      - "50"
      Benign:
      - '71'
    separatecontext: false
    conditions:
    - label: Benign
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: WildFire.Verdicts
                accessor: Verdict
            iscontext: true
          right:
            value:
              simple: '0'
    view: |-
      {
        "position": {
          "x": 1760,
          "y": 2940
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  '71':
    id: '71'
    taskid: 84a13b67-d55d-4914-8a6f-b9a9e72d4413
    type: regular
    task:
      id: 84a13b67-d55d-4914-8a6f-b9a9e72d4413
      version: -1
      name: Flip verdict request to keep WF updated
      description: Reports to WildFire about incorrect hash verdict through Cortex.
      script: '|||core-report-incorrect-wildfire'
      type: regular
      iscommand: true
      brand: ''
    nexttasks:
      '#none#':
      - "46"
    scriptarguments:
      file_hash:
        complex:
          root: WildFire.Report
          accessor: SHA256
      new_verdict:
        simple: '1'
      reason:
        simple: Cortex XDR Local Analysis found the file to be malicious.
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1760,
          "y": 3125
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "75":
    id: "75"
    taskid: 47c79710-4df0-4d52-837e-4fc58b95636f
    type: condition
    task:
      id: 47c79710-4df0-4d52-837e-4fc58b95636f
      version: -1
      name: Is manual review required?
      description: Checks whether the playbook should wait for manual review.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "67"
      "yes":
      - "34"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: inputs.ShouldManualReviewFP
            iscontext: true
          right:
            value:
              simple: "True"
          ignorecase: true
    view: |-
      {
        "position": {
          "x": 430,
          "y": 1840
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "76":
    id: "76"
    taskid: 519e9500-0352-4b16-899f-7822a05b9c4c
    type: title
    task:
      id: 519e9500-0352-4b16-899f-7822a05b9c4c
      version: -1
      name: Flip WildFire Verdict
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "70"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1760,
          "y": 2800
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "77":
    id: "77"
    taskid: 98931c73-8f35-4fab-8d68-47dc2fba0252
    type: regular
    task:
      id: 98931c73-8f35-4fab-8d68-47dc2fba0252
      version: -1
      name: Check for existing WF report
      description: Retrieves results for a file hash using WildFire.
      script: '|||internal-wildfire-get-report'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "78"
    scriptarguments:
      sha256:
        complex:
          root: inputs.SHA256
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 1150
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "78":
    id: "78"
    taskid: 28c41740-e669-414a-848e-4c35394de191
    type: condition
    task:
      id: 28c41740-e669-414a-848e-4c35394de191
      version: -1
      name: Should detonate file?
      description: "Do we have a WildFire report or should we detonate the file?"
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "59"
      "no":
      - "39"
    separatecontext: false
    conditions:
    - label: "no"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: WildFire.Report
                accessor: Status
            iscontext: true
          right:
            value:
              simple: Success
        - operator: isEqualString
          left:
            value:
              simple: inputs.ShouldRescanBenign
            iscontext: true
          right:
            value:
              simple: "True"
          ignorecase: true
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 1350
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "79":
    id: "79"
    taskid: ffff8739-460a-4b5c-80ce-f4d4246be289
    type: title
    task:
      id: ffff8739-460a-4b5c-80ce-f4d4246be289
      version: -1
      name: Continue by Verdict
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "80"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 430,
          "y": -1350
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
    continueonerrortype: ""
  "80":
    id: "80"
    taskid: cf4804c6-9de6-4f8e-8adc-e2ff0ad2e35c
    type: condition
    task:
      id: cf4804c6-9de6-4f8e-8adc-e2ff0ad2e35c
      version: -1
      name: Verdict by DbotScore
      description: "Check if DbotScore equals 3 (Malicious)"
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "2"
      True Positive:
      - "81"
    separatecontext: false
    conditions:
    - label: True Positive
      condition:
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: DBotScore
                accessor: Score
            iscontext: true
          right:
            value:
              simple: "3"
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 430,
          "y": -1200
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "81":
    id: "81"
    taskid: aee235af-9407-46c4-87da-a25cb4e6e594
    type: regular
    task:
      id: aee235af-9407-46c4-87da-a25cb4e6e594
      version: -1
      name: Set Incident Severity to High
      description: commands.local.cmd.set.parent.incident.field
      script: Builtin|||setParentIncidentFields
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "83"
    scriptarguments:
      manual_severity:
        simple: high
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 900,
          "y": -810
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: true
    quietmode: 2
    isoversize: false
    isautoswitchedtoquietmode: false
  "83":
    id: "83"
    taskid: 909f73e8-c2df-4a16-837f-7c47788daec7
    type: condition
    task:
      id: 909f73e8-c2df-4a16-837f-7c47788daec7
      version: -1
      name: Should open a ticket automatically in a ticketing system?
      description: Checks whether to open a ticket automatically in a ticketing system.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "6"
      "yes":
      - "84"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: inputs.ShouldOpenTicket
            iscontext: true
          right:
            value:
              simple: "True"
          ignorecase: true
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 900,
          "y": -650
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "84":
    id: "84"
    taskid: 8717188a-895e-4c98-857e-3395dab6492f
    type: playbook
    task:
      id: 8717188a-895e-4c98-857e-3395dab6492f
      version: -1
      name: Ticket Management - Generic
      description: "`Ticket Management - Generic` allows you to open new tickets or update comments to the existing ticket in the following ticketing systems:\n-ServiceNow \n-Zendesk \nusing the following sub-playbooks:\n-`ServiceNow - Ticket Management`\n-`Zendesk - Ticket Management`\n"
      playbookName: Ticket Management - Generic
      type: playbook
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "6"
    scriptarguments:
      CommentToAdd:
        complex:
          root: inputs.CommentToAdd
      ZendeskAssigne:
        complex:
          root: inputs.ZendeskAssigne
      ZendeskCollaborators:
        complex:
          root: inputs.ZendeskCollaborators
      ZendeskPriority:
        complex:
          root: inputs.ZendeskPriority
      ZendeskRequester:
        complex:
          root: inputs.ZendeskRequester
      ZendeskStatus:
        complex:
          root: inputs.ZendeskStatus
      ZendeskSubject:
        complex:
          root: inputs.ZendeskSubject
      ZendeskTags:
        complex:
          root: inputs.ZendeskTags
      ZendeskType:
        complex:
          root: inputs.ZendeskType
      addCommentPerEndpoint:
        complex:
          root: inputs.addCommentPerEndpoint
      description:
        complex:
          root: inputs.description
      serviceNowAssignmentGroup:
        complex:
          root: inputs.serviceNowAssignmentGroup
      serviceNowCategory:
        complex:
          root: inputs.serviceNowCategory
      serviceNowImpact:
        complex:
          root: inputs.serviceNowImpact
      serviceNowSeverity:
        complex:
          root: inputs.serviceNowSeverity
      serviceNowShortDescription:
        complex:
          root: inputs.serviceNowShortDescription
      serviceNowTicketType:
        complex:
          root: inputs.serviceNowTicketType
      serviceNowUrgency:
        complex:
          root: inputs.serviceNowUrgency
    separatecontext: true
    continueonerrortype: ""
    loop:
      iscommand: false
      exitCondition: ""
      wait: 1
      max: 100
    view: |-
      {
        "position": {
          "x": 1140,
          "y": -480
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: true
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "85":
    id: "85"
    taskid: 7b9fb96d-d06a-44ad-8e7e-73edd9e1b818
    type: title
    task:
      id: 7b9fb96d-d06a-44ad-8e7e-73edd9e1b818
      version: -1
      name: Benign
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "77"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1560,
          "y": 1010
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
  "86":
    id: "86"
    taskid: 8f617900-f04c-4655-81f7-c2e756f78117
    type: title
    task:
      id: 8f617900-f04c-4655-81f7-c2e756f78117
      version: -1
      name: Greyware
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "77"
    separatecontext: false
    continueonerrortype: ""
    view: |-
      {
        "position": {
          "x": 1110,
          "y": 1010
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
    isoversize: false
    isautoswitchedtoquietmode: false
view: |-
  {
    "linkLabelsPosition": {
      "14_39_#default#": 0.23,
      "2_33_#default#": 0.1,
      "2_81_True Positive": 0.62,
      "34_39_No": 0.58,
      "34_67_Yes": 0.54,
      "46_47_#default#": 0.54,
      "46_66_yes": 0.49,
      "55_35_#default#": 0.19,
      "58_35_#default#": 0.33,
      "6_35_Blocked": 0.12,
      "6_57_#default#": 0.58,
      "70_71_Benign": 0.63,
      "75_67_#default#": 0.67,
      "78_39_no": 0.14,
      "78_59_#default#": 0.72,
      "80_2_#default#": 0.48,
      "80_81_True Positive": 0.5,
      "83_84_yes": 0.38
    },
    "paper": {
      "dimensions": {
        "height": 6015,
        "width": 2100,
        "x": 40,
        "y": -1800
      }
    }
  }
inputs:
- key: GraywareAsMalware
  value:
    simple: 'False'
  required: false
  description: 'Whether to treat Grayware verdict as Malware. '
  playbookInputQuery:
- key: AutoContainment
  value:
    simple: 'True'
  required: false
  description: |-
    Setting this input will impact both Containment Plan sub-playbooks. Without setting this input, the default values are True for the first occurrence and False for the second.
    Whether to execute automatically or manually the containment plan tasks:
    * Isolate endpoint
    * Block indicators
    * Quarantine file
    * Disable user
  playbookInputQuery:
- key: AutoEradication
  value:
    simple: 'False'
  required: false
  description: |-
    Whether to execute automatically or manually the eradication plan tasks:
    * Terminate process
    * Delete file
    * Reset the user's password
  playbookInputQuery:
- key: FileRemediation
  value:
    simple: Quarantine
  required: false
  description: Should be either 'Quarantine' or 'Delete'.
  playbookInputQuery:
- key: AutoRecovery
  value:
    simple: 'False'
  required: false
  description: Whether to execute the Recovery playbook.
  playbookInputQuery:
- key: AutoCloseAlert
  value:
    simple: 'False'
  required: false
  description: Whether to close the alert automatically or manually, after an analyst's review.
  playbookInputQuery:
- key: ShouldRescanBenign
  value:
    simple: 'True'
  required: false
  description: Whether to rescan (Using WildFire detonate file) benign files.
  playbookInputQuery:
- key: ShouldManualReviewFP
  value:
    simple: "False"
  required: false
  description: Whether to ask for a manual review before false positive handling. Should be True or False
  playbookInputQuery:
- key: SHA256
  value:
    complex:
      root: alert
      transformers:
      - operator: DT
        args:
          dt:
            value:
              simple: .=pickvalue(val);function pickvalue(x){if(x.filesha256){return x.filesha256} else {return x.initiatorsha256}}
  required: false
  description: The SHA256 hash of the file to respond to. Decided by the DT expression wether it's the initiator or the target file SHA256.
  playbookInputQuery:
- key: Path
  value:
    complex:
      root: alert
      transformers:
      - operator: DT
        args:
          dt:
            value:
              simple: .=pickvalue(val);function pickvalue(x){if(x.filepath){return x.filepath} else {return x.initiatorpath}}
  required: false
  description: The path of the file to respond to. Decided by the DT expression wether it's the initiator or the target file path.
  playbookInputQuery:
- key: Query
  value:
    complex:
      root: alert
      transformers:
      - operator: If-Then-Else
        args:
          condition:
            value:
              simple: lhs!=rhs
          conditionB:
            value:
              simple: lhsB!=rhsB
          conditionInBetween:
            value:
              simple: and
          else:
            value:
              simple: ${alert= '(initiatorsha256:"' + val.initiatorsha256 + '" or agentid:"' + val.agentid + '") ' + 'and sourceBrand:"' + val.sourceBrand + '" and name:"' + val.name + '"'}
          equals: {}
          lhs:
            value:
              simple: alert.filesha256
            iscontext: true
          lhsB:
            value:
              simple: alert.hostip
          options: {}
          optionsB: {}
          rhs: {}
          rhsB: {}
          then:
            value:
              simple: ${alert= '(filesha256:"' + val.filesha256 + '" or agentid:"' + val.agentid + '") ' + 'and sourceBrand:"' + val.sourceBrand + '" and name:"' + val.name + '"'}
  required: false
  description: The query for searching previous alerts based on the file we want to respond to. Decided by the If-Then-Else expression wether it's the initiator or the target file.
  playbookInputQuery:
- key: ShouldOpenTicket
  value:
    simple: "False"
  required: false
  description: Whether to open a ticket automatically in a ticketing system. (True/False).
  playbookInputQuery:
- key: serviceNowShortDescription
  value:
    simple: XSIAM Incident ID - ${parentIncidentFields.incident_id}
  required: false
  description: A short description of the ticket.
  playbookInputQuery:
- key: serviceNowImpact
  value: {}
  required: false
  description: The impact for the new ticket. Leave empty for ServiceNow default impact.
  playbookInputQuery:
- key: serviceNowUrgency
  value: {}
  required: false
  description: The urgency of the new ticket. Leave empty for ServiceNow default urgency.
  playbookInputQuery:
- key: serviceNowSeverity
  value: {}
  required: false
  description: The severity of the new ticket. Leave empty for ServiceNow default severity.
  playbookInputQuery:
- key: serviceNowTicketType
  value: {}
  required: false
  description: The ServiceNow ticket type. Options are "incident", "problem", "change_request", "sc_request", "sc_task", or "sc_req_item". Default is "incident".
  playbookInputQuery:
- key: serviceNowCategory
  value: {}
  required: false
  description: The category of the ServiceNow ticket.
  playbookInputQuery:
- key: serviceNowAssignmentGroup
  value: {}
  required: false
  description: The group to which to assign the new ticket.
  playbookInputQuery:
- key: ZendeskPriority
  value: {}
  required: false
  description: The urgency with which the ticket should be addressed. Allowed values are "urgent", "high", "normal", or "low".
  playbookInputQuery:
- key: ZendeskRequester
  value: {}
  required: false
  description: The user who requested this ticket.
  playbookInputQuery:
- key: ZendeskStatus
  value: {}
  required: false
  description: The state of the ticket. Allowed values are "new", "open", "pending", "hold", "solved", or "closed".
  playbookInputQuery:
- key: ZendeskSubject
  value:
    simple: XSIAM Incident ID - ${parentIncidentFields.incident_id}
  required: false
  description: The value of the subject field for this ticket.
  playbookInputQuery:
- key: ZendeskTags
  value: {}
  required: false
  description: The array of tags applied to this ticket.
  playbookInputQuery:
- key: ZendeskType
  value: {}
  required: false
  description: The type of this ticket. Allowed values are "problem", "incident", "question", or "task".
  playbookInputQuery:
- key: ZendeskAssigne
  value: {}
  required: false
  description: The agent currently assigned to the ticket.
  playbookInputQuery:
- key: ZendeskCollaborators
  value: {}
  required: false
  description: The users currently CC'ed on the ticket.
  playbookInputQuery:
- key: description
  value:
    simple: ${parentIncidentFields.description}. ${parentIncidentFields.xdr_url}
  required: false
  description: The ticket description.
  playbookInputQuery:
- key: addCommentPerEndpoint
  value: {}
  required: false
  description: 'Whether to append a new comment to the ticket for each endpoint in the incident. Possible values: True/False.'
  playbookInputQuery:
- key: CommentToAdd
  value:
    simple: '${alert.name}. Alert ID: ${alert.id}'
  required: false
  description: Comment for the ticket.
  playbookInputQuery:
- key: AgentID
  value:
    complex:
      root: alert
      accessor: agentid
  required: false
  description: The agent ID's of the endpoints in the alert
  playbookInputQuery:
inputSections:
- inputs:
  - AutoCloseAlert
  - ShouldManualReviewFP
  - AgentID
  name: Alert Management
  description: Alert management settings and data, including escalation processes, and user engagements.
- inputs:
  - Query
  - SHA256
  - Path
  name: Enrichment
  description: Enrichment settings and data, including assets and indicators enrichment using third-party enrichers.
- inputs:
  - GraywareAsMalware
  - ShouldRescanBenign
  name: Investigation
  description: Investigation settings and data, including any deep dive alert investigation and verdict determination.
- inputs:
  - AutoEradication
  - AutoContainment
  - FileRemediation
  - AutoRecovery
  name: Remediation
  description: Remediation settings and data, including containment, eradication, and recovery.
- inputs:
  - ShouldOpenTicket
  - serviceNowShortDescription
  - serviceNowImpact
  - serviceNowUrgency
  - serviceNowSeverity
  - serviceNowTicketType
  - serviceNowCategory
  - serviceNowAssignmentGroup
  - ZendeskPriority
  - ZendeskRequester
  - ZendeskStatus
  - ZendeskSubject
  - ZendeskTags
  - ZendeskType
  - ZendeskAssigne
  - ZendeskCollaborators
  - description
  - addCommentPerEndpoint
  - CommentToAdd
  name: Ticket Management
  description: Ticket management settings and data.
outputSections:
- outputs: []
  name: General (Outputs group)
  description: Generic group for outputs
outputs: []
tests:
- Local Analysis alert Investigation - Test
fromversion: 6.6.0
marketplaces:
  - marketplacev2

