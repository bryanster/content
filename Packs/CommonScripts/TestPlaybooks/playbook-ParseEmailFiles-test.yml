description: test test
fromversion: 5.0.0
id: ParseEmailFiles-test
inputs: []
name: ParseEmailFiles-test
outputs: []
starttaskid: '0'
tasks:
  '0':
    id: '0'
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - '1'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: ''
      id: dccbe542-ee37-4cbf-8f2f-a493a7e9bc02
      iscommand: false
      name: ''
      version: -1
    taskid: dccbe542-ee37-4cbf-8f2f-a493a7e9bc02
    timertriggers: []
    type: start
    view: "{\n  \"position\": {\n    \"x\": 450,\n    \"y\": -590\n  }\n}"
  '1':
    id: '1'
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - '19'
    note: false
    quietmode: 0
    scriptarguments:
      all:
        simple: true
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: Delete field from context
      id: f2978fe0-3cf2-48d4-840e-36710a9748c9
      iscommand: false
      name: DeleteContext
      scriptName: DeleteContext
      type: regular
      version: -1
    taskid: f2978fe0-3cf2-48d4-840e-36710a9748c9
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 450,\n    \"y\": -450\n  }\n}"
  '11':
    id: '11'
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      true:
      - '12'
    note: false
    quietmode: 0
    results:
    - AreValuesEqual
    scriptarguments:
      left:
        complex:
          accessor: MD5
          filters:
          - - left:
                iscontext: true
                value:
                  simple: File.Extension
              operator: isEqualString
              right:
                value:
                  simple: pdf
          root: File
      right:
        simple: 9060c2d4f48745de19a5690d8e6cabe1
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: Check whether the values provided in arguments are equal. If either
        of the arguments are missing, no is returned.
      id: 2da41eb2-33ac-46f1-83b0-03cac1ef1178
      iscommand: false
      name: AreValuesEqual - verify pdf attachment
      scriptName: AreValuesEqual
      type: condition
      version: -1
    taskid: 2da41eb2-33ac-46f1-83b0-03cac1ef1178
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 1213,\n    \"y\": 769\n  }\n}"
  '12':
    id: '12'
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - '15'
      - '16'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: ''
      id: 78aae24f-67c9-42f9-89f6-9812a130643a
      iscommand: false
      name: Validate Non-Unicode parsing
      type: title
      version: -1
    taskid: 78aae24f-67c9-42f9-89f6-9812a130643a
    timertriggers: []
    type: title
    view: "{\n  \"position\": {\n    \"x\": 400,\n    \"y\": 1107\n  }\n}"
  '13':
    id: '13'
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      true:
      - '12'
    note: false
    quietmode: 0
    results:
    - AreValuesEqual
    scriptarguments:
      left:
        complex:
          accessor: MD5
          filters:
          - - left:
                iscontext: true
                value:
                  simple: File.Extension
              operator: isEqualString
              right:
                value:
                  simple: docx
          root: File
      right:
        simple: b842aa8664f41a2dd7fe0d47a9fd4724
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: Check whether the values provided in arguments are equal. If either
        of the arguments are missing, no is returned.
      id: 2e2a96fc-e555-4bb7-87ae-2b92f0b9c99b
      iscommand: false
      name: AreValuesEqual - verify docx attachment
      scriptName: AreValuesEqual
      type: condition
      version: -1
    taskid: 2e2a96fc-e555-4bb7-87ae-2b92f0b9c99b
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 780,\n    \"y\": 769\n  }\n}"
  '14':
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: Email.From
          operator: containsGeneral
          right:
            value:
              simple: shachar@demisto.com
      label: true
    id: '14'
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      true:
      - '12'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: 'Verifies path in context:

        - Verifies path existence

        - If matching object is an array: verify fields exists in each of the objects
        in the array

        - If matching object is not an array: verify fields exists in matching object

        - if ''expectedValue'' is given: ensure that the given value is equal to the
        context path'
      id: 5edd2f14-6a9e-4fe2-8220-dbe6417c1e3c
      iscommand: false
      name: VerifyContext - From
      type: condition
      version: -1
    taskid: 5edd2f14-6a9e-4fe2-8220-dbe6417c1e3c
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": -558,\n    \"y\": 769\n  }\n}"
  '15':
    id: '15'
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - '18'
    note: false
    quietmode: 0
    scriptarguments:
      filename:
        simple: EmailWithNonAsciiSubject.eml
      method:
        simple: GET
      saveAsFile:
        simple: true
      url:
        simple: https://github.com/demisto/content/raw/master/TestData/EmailWithNonAsciiSubject.eml
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      id: ffbb472b-bde2-4949-82d6-35fae8dbe609
      iscommand: false
      name: Non Unicode Subject
      scriptName: http
      type: regular
      version: -1
    taskid: ffbb472b-bde2-4949-82d6-35fae8dbe609
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 400,\n    \"y\": 1280\n  }\n}"
  '16':
    id: '16'
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - '17'
    note: false
    quietmode: 0
    scriptarguments:
      filename:
        simple: EmailWithNonAsciiAttachmentName.eml
      method:
        simple: GET
      saveAsFile:
        simple: true
      url:
        simple: https://github.com/demisto/content/raw/master/TestData/EmailWithNonAsciiAttachmentName.eml
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      id: 5c884e25-7a4d-4e7d-8f1a-556f3d21bd0a
      iscommand: false
      name: Non Unicode Attachment Name
      scriptName: http
      type: regular
      version: -1
    taskid: 5c884e25-7a4d-4e7d-8f1a-556f3d21bd0a
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 880,\n    \"y\": 1280\n  }\n}"
  '17':
    id: '17'
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - '24'
    note: false
    quietmode: 0
    results:
    - AttachmentName
    scriptarguments:
      entryid:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: File.Name
              operator: isEqualString
              right:
                value:
                  simple: EmailWithNonAsciiAttachmentName.eml
          root: File
          transformers:
          - args:
              field:
                value:
                  simple: EntryID
            operator: getField
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: Parse an email from an eml or msg file and populate all relevant
        context data to investigate the email. Also extracts inner attachments and
        returns them to the war room. The incident labels themselves are preserved
        and not modified - only the "Label/x" context items that originated from the
        labels, and the best practice is to rely on these for the remainder of the
        playbook. Requires pip and access to python repository to install "olefile"
        package.
      id: 071d0192-09e3-4d82-8aae-e12f8cdd1cbd
      iscommand: false
      name: ParseEmailFiles
      scriptName: ParseEmailFiles
      type: regular
      version: -1
    taskid: 071d0192-09e3-4d82-8aae-e12f8cdd1cbd
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 880,\n    \"y\": 1470\n  }\n}"
  '18':
    id: '18'
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - '24'
    note: false
    quietmode: 0
    results:
    - AttachmentName
    scriptarguments:
      entryid:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: File.Name
              operator: isEqualString
              right:
                value:
                  simple: EmailWithNonAsciiSubject.eml
          root: File
          transformers:
          - args:
              field:
                value:
                  simple: EntryID
            operator: getField
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: Parse an email from an eml or msg file and populate all relevant
        context data to investigate the email. Also extracts inner attachments and
        returns them to the war room. The incident labels themselves are preserved
        and not modified - only the "Label/x" context items that originated from the
        labels, and the best practice is to rely on these for the remainder of the
        playbook. Requires pip and access to python repository to install "olefile"
        package.
      id: f3b2570a-a447-42bf-8fa6-8c4332c9a965
      iscommand: false
      name: ParseEmailFiles
      scriptName: ParseEmailFiles
      type: regular
      version: -1
    taskid: f3b2570a-a447-42bf-8fa6-8c4332c9a965
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 430,\n    \"y\": 1470\n  }\n}"
  '19':
    id: '19'
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - '20'
    note: false
    quietmode: 0
    scriptarguments:
      filename:
        simple: ParseEmailFiles_test_email.eml
      method:
        simple: GET
      saveAsFile:
        simple: true
      url:
        simple: https://raw.githubusercontent.com/demisto/content/master/TestData/no_content_type.eml
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: Sends http request. Returns the response as json.
      id: 08ba85be-9f8e-4491-8446-1a25af48e4ad
      iscommand: false
      name: http (No Content Type)
      scriptName: http
      type: regular
      version: -1
    taskid: 08ba85be-9f8e-4491-8446-1a25af48e4ad
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 450,\n    \"y\": -270\n  }\n}"
  '2':
    id: '2'
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - '3'
    note: false
    quietmode: 0
    scriptarguments:
      filename:
        simple: ParseEmailFiles_test_email.eml
      method:
        simple: GET
      saveAsFile:
        simple: true
      url:
        simple: https://raw.githubusercontent.com/demisto/content/master/TestData/ParseEmailFiles_test_email.eml
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: Sends http request. Returns the response as json.
      id: 942641eb-3629-4fb4-8d42-a646f8c2a0de
      iscommand: false
      name: http
      scriptName: http
      type: regular
      version: -1
    taskid: 942641eb-3629-4fb4-8d42-a646f8c2a0de
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 450,\n    \"y\": 410\n  }\n}"
  '20':
    id: '20'
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - '22'
    note: false
    quietmode: 0
    results:
    - AttachmentName
    scriptarguments:
      entryid:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: File.Name
              operator: isEqualString
              right:
                value:
                  simple: ParseEmailFiles_test_email.eml
          root: File
          transformers:
          - args:
              field:
                value:
                  simple: EntryID
            operator: getField
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: Parse an email from an eml or msg file and populate all relevant
        context data to investigate the email. Also extracts inner attachments and
        returns them to the war room. The incident labels themselves are preserved
        and not modified - only the "Label/x" context items that originated from the
        labels, and the best practice is to rely on these for the remainder of the
        playbook. Requires pip and access to python repository to install "olefile"
        package.
      id: 8d8955d3-c383-4837-8d01-bcbc800639e4
      iscommand: false
      name: ParseEmailFiles With No Content Type
      scriptName: ParseEmailFiles
      type: regular
      version: -1
    taskid: 8d8955d3-c383-4837-8d01-bcbc800639e4
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 450,\n    \"y\": -100\n  }\n}"
  '21':
    id: '21'
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - '2'
    note: false
    quietmode: 0
    scriptarguments:
      all:
        simple: true
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: Delete field from context
      id: 356d6938-e013-4aa0-8c5b-15afee7067cf
      iscommand: false
      name: DeleteContext
      scriptName: DeleteContext
      type: regular
      version: -1
    taskid: 356d6938-e013-4aa0-8c5b-15afee7067cf
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 450,\n    \"y\": 245\n  }\n}"
  '22':
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: Email.Headers.value
          operator: isEqualString
          right:
            value:
              simple: '"woo@demisto.com" <woo@demisto.com>'
      - - left:
            iscontext: true
            value:
              simple: Email.Headers.value
          operator: isEqualString
          right:
            value:
              simple: '"Demisto Dbot" <woo@demisto.com>'
      - - left:
            iscontext: true
            value:
              simple: Email.Headers.value
          operator: isEqualString
          right:
            value:
              simple: from prod.outlook.com
      label: true
    id: '22'
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      true:
      - '21'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      id: ad2e3433-01e0-4dd4-8383-f8ae29f4e338
      iscommand: false
      name: Verify Headers
      type: condition
      version: -1
    taskid: ad2e3433-01e0-4dd4-8383-f8ae29f4e338
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 450,\n    \"y\": 60\n  }\n}"
  '24':
    id: '24'
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - '25'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: ''
      id: 35ccc5dc-7b90-4827-852b-2614d9b32fef
      iscommand: false
      name: Validate Error is not raised with special chars
      type: title
      version: -1
    taskid: 35ccc5dc-7b90-4827-852b-2614d9b32fef
    timertriggers: []
    type: title
    view: "{\n  \"position\": {\n    \"x\": 600,\n    \"y\": 1740\n  }\n}"
  '25':
    id: '25'
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - '26'
    note: false
    quietmode: 0
    scriptarguments:
      filename:
        simple: EmailWithSpecialChars.eml
      method:
        simple: GET
      saveAsFile:
        simple: true
      url:
        simple: https://github.com/demisto/content/raw/7fc44134eea661749600f14a26d9722a8fbe3ab8/Packs/CommonScripts/Scripts/ParseEmailFiles/test_data/test-subject-raised-error-on-log.eml
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      id: ed99483a-6037-4b94-8da6-4796518f1fa2
      iscommand: false
      name: Organization header with MIME encoded-word
      scriptName: http
      type: regular
      version: -1
    taskid: ed99483a-6037-4b94-8da6-4796518f1fa2
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 600,\n    \"y\": 1930\n  }\n}"
  '26':
    id: '26'
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    results:
    - AttachmentName
    scriptarguments:
      entryid:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: File.Name
              operator: isEqualString
              right:
                value:
                  simple: EmailWithSpecialChars.eml
          root: File
          transformers:
          - args:
              field:
                value:
                  simple: EntryID
            operator: getField
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: Parse an email from an eml or msg file and populate all relevant
        context data to investigate the email. Also extracts inner attachments and
        returns them to the war room. The incident labels themselves are preserved
        and not modified - only the "Label/x" context items that originated from the
        labels, and the best practice is to rely on these for the remainder of the
        playbook.
      id: 825b53dc-a2c1-44ff-86fd-ac014da8418d
      iscommand: false
      name: ParseEmailFiles
      scriptName: ParseEmailFiles
      type: regular
      version: -1
    taskid: 825b53dc-a2c1-44ff-86fd-ac014da8418d
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 600,\n    \"y\": 2140\n  }\n}"
  '3':
    id: '3'
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - '4'
      - '8'
      - '11'
      - '13'
      - '14'
    note: false
    quietmode: 0
    results:
    - AttachmentName
    scriptarguments:
      entryid:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: File.Name
              operator: isEqualString
              right:
                value:
                  simple: ParseEmailFiles_test_email.eml
          root: File
          transformers:
          - args:
              field:
                value:
                  simple: EntryID
            operator: getField
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: Parse an email from an eml or msg file and populate all relevant
        context data to investigate the email. Also extracts inner attachments and
        returns them to the war room. The incident labels themselves are preserved
        and not modified - only the "Label/x" context items that originated from the
        labels, and the best practice is to rely on these for the remainder of the
        playbook. Requires pip and access to python repository to install "olefile"
        package.
      id: ce78f9bf-039b-40ec-8103-b53bf9f804ba
      iscommand: false
      name: ParseEmailFiles
      scriptName: ParseEmailFiles
      type: regular
      version: -1
    taskid: ce78f9bf-039b-40ec-8103-b53bf9f804ba
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 450,\n    \"y\": 590\n  }\n}"
  '4':
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: Email.To
          operator: containsGeneral
          right:
            value:
              simple: shachar@demisto.com, yaakovi@demisto.com
      label: true
    id: '4'
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      true:
      - '12'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: 'Verifies path in context:

        - Verifies path existence

        - If matching object is an array: verify fields exists in each of the objects
        in the array

        - If matching object is not an array: verify fields exists in matching object

        - if ''expectedValue'' is given: ensure that the given value is equal to the
        context path'
      id: ca638548-ddfa-4752-8a92-66c7fa999386
      iscommand: false
      name: VerifyContext - To
      type: condition
      version: -1
    taskid: ca638548-ddfa-4752-8a92-66c7fa999386
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 352,\n    \"y\": 769\n  }\n}"
  '8':
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: Email.Subject
          operator: containsGeneral
          right:
            value:
              simple: ParseEmail test email
      label: true
    id: '8'
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      true:
      - '12'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: 'Verifies path in context:

        - Verifies path existence

        - If matching object is an array: verify fields exists in each of the objects
        in the array

        - If matching object is not an array: verify fields exists in matching object

        - if ''expectedValue'' is given: ensure that the given value is equal to the
        context path'
      id: 186c4430-d133-4448-87a1-976657212fef
      iscommand: false
      name: VerifyContext - Subject
      type: condition
      version: -1
    taskid: 186c4430-d133-4448-87a1-976657212fef
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": -120,\n    \"y\": 769\n  }\n}"
version: -1
view: "{\n  \"linkLabelsPosition\": {},\n  \"paper\": {\n    \"dimensions\": {\n \
  \     \"height\": 2825,\n      \"width\": 2151,\n      \"x\": -558,\n      \"y\"\
  : -590\n    }\n  }\n}"
