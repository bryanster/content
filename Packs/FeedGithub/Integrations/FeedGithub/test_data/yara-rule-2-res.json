[
    {
        "value": "HvS_APT27_HyperBro_Decrypted_Stage2",
        "type": "YARA Rule",
        "service": "github",
        "fields": {
            "value": "HvS_APT27_HyperBro_Decrypted_Stage2",
            "description": "HyperBro Stage 2 and compressed Stage 3 detection",
            "author": "Moritz Oettle",
            "rulereference": "https://www.hvs-consulting.de/en/threat-intelligence-report-emissary-panda-apt27",
            "sourcetimestamp": "2022-02-07",
            "id": "039e5d41-eadb-5c53-82cd-20ffd4105326",
            "rulestrings": [
                {
                    "index": "$lznt1_compressed_pe_header_small",
                    "string": "{ FC B9 00 4D 5A 90 }",
                    "type": "byte",
                    "modifiers": ""
                },
                {
                    "index": "$lznt1_compressed_pe_header_large_1",
                    "string": "{ FC B9 00 4D 5A 90 00 03 00 00 00 82 04 00 30 FF FF 00 }",
                    "type": "byte",
                    "modifiers": ""
                },
                {
                    "index": "$lznt1_compressed_pe_header_large_2",
                    "string": "{ 00 b8 00 38 0d 01 00 40 04 38 19 00 10 01 00 00 }",
                    "type": "byte",
                    "modifiers": ""
                },
                {
                    "index": "$lznt1_compressed_pe_header_large_3",
                    "string": "{ 00 0e 1f ba 0e 00 b4 09 cd 00 21 b8 01 4c cd 21 }",
                    "type": "byte",
                    "modifiers": ""
                },
                {
                    "index": "$lznt1_compressed_pe_header_large_4",
                    "string": "{ 54 68 00 69 73 20 70 72 6f 67 72 00 61 6d 20 63 }",
                    "type": "byte",
                    "modifiers": ""
                },
                {
                    "index": "$lznt1_compressed_pe_header_large_5",
                    "string": "{ 61 6e 6e 6f 00 74 20 62 65 20 72 75 6e 00 20 69 }",
                    "type": "byte",
                    "modifiers": ""
                },
                {
                    "index": "$lznt1_compressed_pe_header_large_6",
                    "string": "{ 6e 20 44 4f 53 20 00 6d 6f 64 65 2e 0d 0d 0a 02 }",
                    "type": "byte",
                    "modifiers": ""
                }
            ],
            "condition": "filesize < 200KB and ( $lznt1_compressed_pe_header_small at 0x9ce ) or ( all of ( $lznt1_compressed_pe_header_large_* ) )",
            "references": "example.com",
            "raw rule": "``` \n rule HvS_APT27_HyperBro_Decrypted_Stage2 {\n   meta:\n      description = \"HyperBro Stage 2 and compressed Stage 3 detection\"\n      license = \"https://creativecommons.org/licenses/by-nc/4.0/\"\n      author = \"Moritz Oettle\"\n      reference = \"https://www.hvs-consulting.de/en/threat-intelligence-report-emissary-panda-apt27\"\n      date = \"2022-02-07\"\n      hash1 = \"fc5a58bf0fce9cb96f35ee76842ff17816fe302e3164bc7c6a5ef46f6eff67ed\"\n      id = \"039e5d41-eadb-5c53-82cd-20ffd4105326\"\n   strings:\n      $lznt1_compressed_pe_header_small = { FC B9 00 4D 5A 90 } // This is the lznt1 compressed PE header\n\n      $lznt1_compressed_pe_header_large_1 = { FC B9 00 4D 5A 90 00 03 00 00 00 82 04 00 30 FF FF 00 } \n      $lznt1_compressed_pe_header_large_2 = { 00 b8 00 38 0d 01 00 40 04 38 19 00 10 01 00 00 }\n      $lznt1_compressed_pe_header_large_3 = { 00 0e 1f ba 0e 00 b4 09 cd 00 21 b8 01 4c cd 21 }\n      $lznt1_compressed_pe_header_large_4 = { 54 68 00 69 73 20 70 72 6f 67 72 00 61 6d 20 63 }\n      $lznt1_compressed_pe_header_large_5 = { 61 6e 6e 6f 00 74 20 62 65 20 72 75 6e 00 20 69 }\n      $lznt1_compressed_pe_header_large_6 = { 6e 20 44 4f 53 20 00 6d 6f 64 65 2e 0d 0d 0a 02 }\n\n   condition:\n      filesize < 200KB and\n      ($lznt1_compressed_pe_header_small at 0x9ce) or (all of ($lznt1_compressed_pe_header_large_*))\n} \n ```"
        },
        "score": 0,
        "firstseenbysource": "2024-05-12T15:30:49.330015",
        "rawJSON": {
            "value": "HvS_APT27_HyperBro_Decrypted_Stage2",
            "type": "YARA Rule"
        }
    }
]